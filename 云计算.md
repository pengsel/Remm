# 云计算

实现了资源和计算能力的分布式共享。计算能力、存储能力、各种功能应用通过网络从云端获得。

云计算是处理大数据的手段。

主要技术：

虚拟化技术

IaaS、SaaS、PaaS

OpenStack、Spark、Hadoop



技术基础：

并行计算、分布式计算、网格计算。



云计算是一个融合产物，就像一个电网：

网格计算

分布式计算

并行计算

效用计算

网络存储

虚拟化

负载均衡





商业计算模型，将计算任务分步子啊大量计算机构成的资源池上，使得应用系统能够根据需要获取计算力、存储空间和信息服务。



基本特征：

* 按需自助服务
* 无处不在的网络接入
* 敏捷的弹性：快速弹性提供和释放资源
* 资源池
* 可度量的服务



IaaS 基础设施

* 把计算、存储、网络以及搭建应用环境所需的一些工具当成服务提供给用户，使得用户可以按需获取IT基础设施。
* 主要由计算机硬件、网络、存储设备、平台虚拟化环境、效用计费方法、服务级别协议等组成。



PaaS平台

* 分布式平台服务，为用户提供一个包括应用设计、开发、测试和托管的完整的计算机平台。



SaaS应用

* 为了满足用户需求提供的软件的计算能力。
* 云服务提供商负责维护管理云中的软件和支持软件运行的硬件设施，用户无需管理。 







部署模式：

私有云，公有云，混合云



混合云：由私有云和外部云提供商构建的混合云计算模式，可以在公有云上运行非核心应用程序，而在私有云上支持其核心程序及内部敏感数据。





变革体现：

IT的服务化

无需数据丢失

容易全球化



硬件变革：

* 扩充模式：转变成不断增加集群规模的横向扩充模式
* 设备总量：通过虚拟化将众多服务器组成一个巨大的资源池
* 设备形态：客户端和移动设备的需求增加





生态系统

硬件：服务器，存储设备。

软件：资源调度和管理系统，云平台软件和应用软件。

服务：云服务，云支撑服务

网络：泛在网络访问特性

安全：服务可用性、数据安全性





## 虚拟化技术

利用软件或者固件管理程序构成虚拟化层，把物理资源映射为虚拟资源。

在虚拟资源上可以安装和部署多个虚拟机，实现多用户共享物理资源。



### 服务器虚拟化

将一个或多个物理服务器虚拟成多个逻辑上的服务器，集中管理，能跨越物理平台不受限制。

两种方向：

* 把一个物理的服务器虚拟成若干独立的逻辑服务器，如分区
* 把若干分散的物理服务器虚拟成一个大的逻辑服务器，如网格技术

分成寄居虚拟化和裸机虚拟化。

#### 寄居虚拟化

寄居虚拟化的虚拟化层成为虚拟机监控器(VMM)。

系统损耗比较大，没有独立的Hypervisor层。

#### 裸机虚拟化

直接把VMM安装在服务器硬件设备上。

本质上VMM也认为是一个操作系统，称之为Hypervisor，实现虚拟到物理的映射。



CPU虚拟化、内存虚拟化、I/O虚拟化



虚拟机迁移

预迁移，预定资源，预复制，停机复制，提交，启动



网络资源的迁移

协议状态以及IP地址都要随之迁移

在局域网内，可以通过发送ARP重定向包，将VM的IP地址与目的机器的MAC地址相绑定，之后的所有包就可以发送到目的机器。



存储设备的迁移

会占用大量时间和网络带宽，通常的解决方案是以共享的方式共享数据和文件系统，而不是真正的迁移。



虚拟机隔离

在没有授权许可的情况下，互相之间不可通信、不可联系的技术

网络隔离

虚拟机安全文件防护网

IP地址隔离



### 存储虚拟化

将存储网络中各个分散且异构的存储设备按照一定的策略映射成一个统一的连续编址的逻辑存储空间。

存储技术分类：

* RAID  磁盘阵列
* NAS（NetWork Attached Storage） 网络连接存储技术
  * 专用文件服务器
  * 标准网络协议加入网络
* SAN 存储区域网络技术
  * 专门为存储建立的独立于TCP/IP网络之外的专用网络
  * 磁盘阵列连接高速通信网络



基于主机的存储虚拟化，在主机实现

基于存储设备的存储虚拟化，在设备实现

基于网络的 存储虚拟化



难点：

数据状态的一致性

多存储访问协议支持

存储多链路负载均衡

主机多链路负载均衡



整合&虚拟化

管理自动化

面向服务的管理



### 网络虚拟化

让一个物理网络能够支持支持多个虚拟网络，虚拟化保存了网络设计中原有的层次结构、数据通道和所能提供的服务，使得最终用户的体验和独享物理网络一样。





交换机网络

服务器之间操作系统和上层软件异构、接口和数据格式不一致

数据中心网络传输效率低





数据中心超大容量

统一交换网络



拓扑结构



成熟的网络虚拟化技术

网卡虚拟化(NIC Virtualization)

* 单根I/O虚拟化

硬件设备虚拟化

链路虚拟化

* 链路聚合
* 隧道协议
  * 数据帧重新封装
  * 隐藏中间节点的网络地址
  * 数据加密

  虚拟网络

* 层叠网络

* VPN网络
  * 通过公用的网络架构传送内联网的信息
* 虚拟二层延伸网络

### 软件定义网络SDN

网络分为控制层和数据层

控制层的控制器软件，通过特定传输通道，统一下达命令给数据层设备

数据层设备依靠控制层的命令转发数据报



## 实验

打开网络连接

cd /etc/sysconfig/network-scripts/

vi ifcfg-----

ONBOOT = yes



service networlk restart







## IaaS

基础设施即服务



虚拟化



多实例

隔离性







CPU虚拟化  分时复用

内存虚拟化

IO

网络

 





## OpenStack

通过仪表板，为管理员提供计算、存储和网络资源的管理控制，同时通过Web界面为用户提供资源。

Nova计算模块+Swift存储服务



为可大规模灵活扩展的云计算操作系统，任何组织均可以通过OpenStack基于标准化的硬件设施创建和提供云计算服务。



首要任务是简化云的部署过程并为其带来良好的可扩展性，该项目提供了框架标准和API，用户以此为基础构建云计算解决方案。





### 计算服务Nova

本身不包括任何虚拟化软件，但可以通过虚拟化技术相关联的驱动程序来集成许多常见的虚拟机管理程序。它通过Libvirt API与被支持的虚拟机监控程序交互，通过web服务API对外提供服务。



无共享架构，主要的部件都可以在不同的服务器上运行，分布式设计依赖于一个消息队列来处理组件对组件的异步通信。



API Server对外提供一个与云基础设施交互的接口，也
是外部可用于管理基础设施的唯一组件。

OpenStack节点之间通过消息队列使用AMQP（Advanced
Message Queue Protocol）完成通信。



#### Libvirt

为各种虚拟化工具提供一套方便、可靠的
编程接口，用一种单一的方式管理多种不同的虚拟化提供方式。



### Docker技术与实现

应用程序标准化

Build,ship, and Run any App， anywhere



应用程序级别的资源隔离和配额。

Linux的容器技术。



简化配置

整合服务器

多租户

代码流水线

隔离应用

调试能力

快速部署



和传统虚拟机区别

通过Hypervisor在主操作系统上运行多个从操作系统，相互隔离。

Docker使用DockerEngine来代替Hypervisor。















